<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <!--<script type="text/javascript" src="highstock/jquery-1.9.1.js" charset="UTF-8"></script>-->
    <script type="text/javascript" src="jquery-1.9.1.min.js" charset="UTF-8"></script>
    <script type="text/javascript" src="highstock/highstock.js" charset="UTF-8"></script>
    <script language="JavaScript" src="define.js?rnd=1"></script>
    <script language="JavaScript" src="app-all.js"></script>


    <script language="javascript">
        Date.prototype.Format = function (fmt) { //author: meizz
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }

        $(document).ready(function(){
            if (chart) {
                // alert('chart.yAxis[0]') ;
                chart.yAxis[0].setTitle({
                    text : '',
                    margin : 0
                }) ;

                // 设置 Tooltip 的样式
                // 禁用 Tooltip 时，直接返回 false;
                var tooltipOptions = chart.tooltip.options;
                tooltipOptions.formatter = function () {
                    var _date=new Date(parseInt(this.x ) );
                    return this.y.toFixed(1)+'<br/>'+_date.Format("yyyy-MM-dd hh:mm");
                };
            }

            $(window).on('popstate', function() {
                console.log('Chart Page Back button was pressed.');
            });

            $(window).on('hashchange', function() {
                console.log('Chart hashchange.');
            });

        });


        buildParam(window.location.search) ;

        var interval = parseInt( parames['interval'] ) ;

        var autoUpdate = function() {

            var barCount = parames['barCount'] || null ;

            getHisData(parames['symbolCode'],parames['period'],barCount,function(mapData){
                testDraw(mapData) ;
            });

            if (interval>0) {
                // console.log(interval) ;
                //setTimeout(autoUpdate,interval * 1000 ) ;
            }

        };


        var manUpdate =function(symbolCode,period,barCount){
            chart.setTitle({
                text: symbolCode
            });
            var _barCount = barCount || null ;
            getHisData(symbolCode,period,_barCount,function(mapData){
                testDraw(mapData) ;
            });
        };

        autoUpdate() ;

    </script>

</head>
<body style="margin:0px; width: 100% ; height: 100%">

<div id="container" style="width: 100% ; height: 100%; margin: 0px; background:#000000; border: 0px solid #000000"></div>

</body>
</html>
